@(user: User, collection: Collection)

@availableContent = @{
    collection.getContent
}

@if(user.hasCollectionPermission(collection, "removeContent")) {
    <script type="text/javascript" src='@routes.Assets.at("javascripts/pageScripts/viewCollection.js")'></script>
    <div id="removeContentModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="removeContentModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">        
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                    <h3 id="removeContentModalLabel">Remove content from this collection.</h3>
                </div>

                <div class="modal-body">

                    @if(availableContent.isEmpty) {
                        <strong><em>There is no content in this collection.</em></strong>
                    } else {
                        <form class="form-horizontal" id="removeContentForm" method="post" action="@routes.Collections.removeContent(collection.id.get)">
                           <div class="container-fluid"> 
			       <div class="form-group">
                               <label class="control-label" for="removeContent">Content to remove:</label>
                                   <div class="controls">  
                                       <select id="removeContent" name="removeContent" multiple="multiple">
                                           @for(contentObj <- availableContent) {
                        	               <option value="@contentObj.id.get">@contentObj.name (@contentObj.contentType.name)</option>
                	                   }
        	                       </select>
	                           </div>
                                   <input type="submit" style="position: absolute; left: -9999px; width: 1px; height: 1px;"/>
                               </div>
			    </div>
                        </form>
                    }
                </div>
                <div class="modal-footer">
                    <button class="btn btn-gray" data-dismiss="modal" aria-hidden="true">Close</button>
                    @if(!availableContent.isEmpty) {
                        <button class="btn btn-blue" id="removeContentButton" disabled="true">Remove Content</button>
                    }
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        $(function() {
            @if(!availableContent.isEmpty) {
                var removeButton = document.getElementById("removeContentButton");
                removeButton.addEventListener('click', function(){
                    $("#removeContentForm").submit();
                }, false);
                document.getElementById("removeContent").addEventListener('change', function(){
                    if (this.value == '') {
                        removeButton.disabled = true;
                    } else {
                        removeButton.disabled = false;
                    }
                }, false);
            }
        });
    </script>
}
