@(path: String)(implicit request: RequestHeader)

<!DOCTYPE html>
<html>
<head>
    <title>Y-Video</title>
    @Dependencies(
      Local(
        Icon("images/favicon.png", "image/png"),
        Rel("stylesheets/",
          CSS("bootstrap.min.css"),
          CSS("bootstrap-responsive.min.css"),
          CSS("font-awesome.min.css"),
          CSS("main.css"),
          CSS("index.css")),
        Rel("javascripts/",
          Rel("libraries/",
            JS("jquery.min.js"),
            JS("bootstrap.min.js")),
          JS("pageScripts/index.js")))
    )
</head>
<body>

    <div class="container-fluid">
        <div class="text-center">
            <img src="@routes.Assets.at("images/logo.png")" style="height: 200px; margin-top: 20px;">

            <div id="titles">
                <div class="title active">
                    <h1>Watch Videos, Learn Languages</h1>
                </div>
                <div class="title">
                    <h1>Improve comprehension with subtitles</h1>
                </div>
                <div class="title">
                    <h1>Better your language listening</h1>
                </div>
            </div>

        </div>

        <!--<h1>Y-Video <small>A better way to learn languages with video.</small></h1>-->

        <div class="getStarted">

            @if(request.flash.get("alert").isDefined) {
                <div class="alert alert-warning">
                    <a class="close" data-dismiss="alert">×</a>
                    <strong>Just a sec...</strong> @request.flash("alert")
                </div>
            }
            @if(request.flash.get("error").isDefined) {
                <div class="alert alert-error">
                    <a class="close" data-dismiss="alert">×</a>
                    <strong>Oh snap!</strong> @request.flash("error")
                </div>
            }
            @if(request.flash.get("success").isDefined) {
                <div class="alert alert-success">
                    <a class="close" data-dismiss="alert">×</a>
                    <strong>Alright!</strong> @request.flash("success")
                </div>
            }
            @if(request.flash.get("info").isDefined) {
                <div class="alert alert-info">
                    <a class="close" data-dismiss="alert">×</a>
                    <strong>Heads up.</strong> @request.flash("info")
                </div>
            }

            <div class="text-center">
                <a class="btn btn-blue btn-lg" href="@controllers.authentication.routes.Cas.login("login", path)"><img src="@routes.Assets.at("images/auth/byu.png")" /> Sign in with BYU</a>
            </div>

            <hr>

            <div class="text-center">
                <a href="#loginModal" class="btn btn-yellow btn-lg" data-toggle="modal">Admin Login</a>
            </div>
        </div>

        <div id="aboutAyamel">
            <div class="container-fluid">
                <div class="justify-content-md-center">
                    <div class="col-md-4">
                        <h3 class="text-center"><span class="ayamel-icon"></span> What is Y-Video?</h3>
                        <p>
                            Y-Video is a web-based system for streaming video and audio content especially as it applies to
                            learning a foreign language. It houses a collection of media all with the express purpose of
                            helping you learn languages.
                        </p>
                    </div>
                    <div class="col-md-4">
                        <h3 class="text-center"><i class="icon-comment"></i> Text helps</h3>
                        <p>
                            Additional aids are available to be used in conjunction with the
                            media, such as captions and annotations. A key feature of the site enables learners to directly
                            interact with subtitle tracks to quickly access translations for foreign words and phrases and
                            view relevant annotations.
                        </p>
                    </div>
                    <div class="col-md-4">
                        <h3 class="text-center"><i class="icon-pencil"></i> For school</h3>
                        <p>
                            Teachers or course designers are able to aggregate media into a single location and set up specific
                            conditions in order to optimize the learning experience. Statistics and analytics are available to
                            improve the learning experience.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="closing">
        <div>Brought about by the <a href="http://arclite.byu.edu">ARCLITE Lab</a></div>
        <div>Copyright © 2013 <a href="http://byu.edu">Brigham Young University</a></div>
        <div>Funding from <a href="http://www.thelanguageflagship.org/">The Language Flagship</a></div>
    </div>

    <div id="signupModal" class="modal fade" role="dialog" aria-labelledby="signupModalLabel">
        <div class="modal-dialog">
            <div class="modal-content">    
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">×</button>
                    <h3 id="signupModalLabel">Create an account</h3>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal" id="signupForm" method="post" action="@controllers.authentication.routes.Password.createAccount(path)">
                    <div class="form-group">
                        <label class="control-label col-sm-4" for="username">Username</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control" id="username" name="username" placeholder="Username" autofocus>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-4" for="password1">Password</label>
                        <div class="col-sm-6">
                            <input type="password" class="form-control" id="password1" name="password1" placeholder="Password">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-4" for="password2">Password again</label>
                        <div class="col-sm-6">
                            <input type="password" class="form-control" id="password2" name="password2" placeholder="Password again">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-4" for="name">Your name</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control" id="name" name="name" placeholder="Your name">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-4" for="email">Email address</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control" id="email" name="email" placeholder="Email address">
                            <input type="submit" style="position: absolute; left: -9999px"/>
                        </div>
                    </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-gray" data-dismiss="modal">Close</button>
                    <button id="signup" class="btn btn-blue">Sign up</button>
                </div>
            </div>
        </div>
    </div>


  <div id="loginModal" class="modal fade" role="dialog" aria-labelledby="loginModalLabel" >
    <div class="modal-dialog">
    
      <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" >×</button>
            <h3 id="loginModalLabel">Sign in</h3>
        </div>
        <div class="modal-body">
          <form class="form-horizontal" id="loginForm" method="post" action="@controllers.authentication.routes.Password.login("login", path)">
            <div class="form-group">
            <label class="control-label col-sm-4" for="username">Username:</label>
            <div class="col-sm-6">
                <input class="form-control" id="username" name="username" placeholder="Enter username">
            </div>
            </div>
            <div class="form-group">
            <label class="control-label col-sm-4" for="password">Password:</label>
            <div class="col-sm-6">          
                <input type="password" class="form-control" id="password" name="password" placeholder="Enter password">
                <input type="submit" style="position: absolute; left: -9999px"/>
            </div>
            </div>
            </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-gray" data-dismiss="modal">Close</button>
            <button id="login" class="btn btn-blue">Sign in</button>
        </div>
      </div>
      
    </div>
  </div>

    <div id="konamiContainer">
        <style>
            #konamiContainer {margin:0px;padding:0px;border:0px;color:#0c0;font-family: "Lucida Console", monaco, monospace;overflow: wrap;word-break:break-all;
                position: absolute;top: 0;height: 100%;width: 100%;background-color: black;display:none;}
            body {background-color: black;}
            #past div div {display: inline;}
            #present div {display: inline;}
            #cursor {height:100%;background-color:#0c0;}
            .blink {animation: blinker 1s linear infinite;}
            @@keyframes blinker {  
              50% { opacity: 0.0; }
            }
        </style>
    </div>

    <script type="text/javascript">
        $(function() {
            document.getElementById("login").addEventListener('click', function(){
                $("#loginForm").submit();
            }, false);
            document.getElementById("signup").addEventListener('click', function(){
                $("#signupForm").submit();
            }, false);
        });
        $('#loginModal').on('shown.bs.modal', function() {
            $(this).find('[autofocus]').focus();
        });
        $('#signupModal').on('shown.bs.modal', function() {
            $(this).find('[autofocus]').focus();
        });
    </script>

    <script type="text/javascript">
    var cnct = null;
    let konami = [38, 38, 40, 40, 37, 39, 37, 39, 66, 65], index = 0;
    window.addEventListener('keydown', (event) => {
        if(event.keyCode == konami[index]){
            index++;
            if(index >= konami.length){
                if (cnct == null) {
                    cnct  = new Cnct();
                    cnct.create(document.getElementById("konamiContainer"));
                }
                index = 0;
            }
        }
        else{
            index = 0;
        }
    });
    class Shell {
        constructor(procs, cnct) {
            this.procs = procs;
            this.cnct = cnct;
        }

        lex(string) {
            let tokens = string.split(" ").filter((str) => { return str !== ""; });
            return tokens;
        }

        parse( expr ) {
            if (this.procs.hasOwnProperty(expr[0])) {
                let op = expr.shift();
                return new Shell.Command( this.procs[op], expr );
            } else {
                return null;
            }
        }

        run( ast ) {
            if (ast != null){
                console.log(ast.operator.apply( ast, ast.args ));
                return ast.operator.apply( ast, ast.args );
            } else {
                return "Function Does not exist.";
            }
        }

        interp( cs ) {
            let lxd = this.lex( cs );
            let ast = this.parse( lxd );
            return this.run( ast );
        }
    }
    Shell.Command = class Command {
        constructor( operator, args ) {
            this.args = args;
            this.operator = operator;
        }
    };
    class Cnct {
        constructor() {
            this.cnctString = '<div id="cnct"><div id="past"></div> <div id="present"> <div id="PS1">test></div> <div id="cmd"></div><div id="cursor" class="blink">*</div> </div></div>';
            this.parseElement = document.createElement("div");
            this.cnct = this.parse(this.cnctString);

            this.shell = new Shell({
                "exit": () => {
                    this.destroy();
                    /* | mem leak? */
                    /* V   ???     */
                    cnct = null;
                },
                "echo": (str) => {
                    return str;
                },
                "login"
            }, this);
        }

        parse(text) {
            var frag;
            this.parseElement.innerHTML = text;
            if(this.parseElement.childNodes.length > 1){
                frag = document.createDocumentFragment();
                [].slice.call(this.parseElement.childNodes).forEach(frag.appendChild.bind(frag));
                return frag;
            }else{
                return this.parseElement.firstChild;
            }
        }

        keypressListener(e) {
            var cmdEl = document.getElementById("cmd");
            var ps1 = document.getElementById("PS1");
            var past = document.getElementById("past");
            if (e.keyCode == 32) {
                cmdEl.innerHTML += "&nbsp;";
            } else if (e.keyCode == 13) {
                /* do nothing on <enter key> */
            } else {
                cmdEl.innerHTML += String.fromCharCode(e.keyCode);
            }
        }

        keydownListener(e) {
            var cmdEl = document.getElementById("cmd");
            var ps1 = document.getElementById("PS1");
            var past = document.getElementById("past");
            if (e.keyCode === 8) {
                /* <backspace key> */
                if (cmdEl.innerHTML.endsWith("&nbsp;")) {
                    cmdEl.innerHTML = cmdEl.innerHTML.slice(0,-6);
                } else if (cmdEl.innerHTML.endsWith("&amp;")) {
                    cmdEl.innerHTML = cmdEl.innerHTML.slice(0,-5);
                } else {
                    cmdEl.innerHTML = cmdEl.innerHTML.slice(0,-1);
                }
            } else if (e.keyCode === 13) {
                // <enter key>
                let text = cmdEl.innerText.replace(String.fromCharCode(160), " ");
                let output = this.shell.interp(text);

                var p = document.createElement("div"),
                    c = document.createElement("div"),
                    f = document.createElement("div");
                p.innerHTML = ps1.innerHTML+" ";
                c.innerHTML = cmdEl.innerHTML + "<br>" + output;
                f.appendChild(p);
                f.appendChild(c);

                cmdEl.innerHTML = "";

                past.appendChild(f);
            }
        }

        create(element) {
            this.kpl = this.keypressListener.bind(this);
            this.kdl = this.keydownListener.bind(this);
            window.addEventListener('keypress', this.kpl, false);
            window.addEventListener('keydown', this.kdl, false);
            element.appendChild(this.cnct);
            document.getElementById('konamiContainer').style.display = "block";
        }

        destroy() {
            window.removeEventListener('keypress', this.kpl, false);
            window.removeEventListener('keydown', this.kdl, false);
            this.cnct.remove();
            document.getElementById('konamiContainer').style.display = "none";
        }
    }
    </script>
</body>
</html>
